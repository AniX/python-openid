<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>openid.consumer.interface</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css"></link>
</head>
<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">

<!-- =========== START OF NAVBAR =========== -->
<table class="navbar" border="0" width="100%" cellpadding="0" bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="center">
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="indices.html">Index</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <font size="-1"><b class="breadcrumbs">
        Package&nbsp;openid ::
        Package&nbsp;consumer ::
        Module&nbsp;interface
      </b></font></br>
    </td>
    <td><table cellpadding="0" cellspacing="0">
      <tr><td align="right"><font size="-2">[<a href="../private/openid.consumer.interface-module.html">show&nbsp;private</a>&nbsp;|&nbsp;hide&nbsp;private]</font></td></tr>
      <tr><td align="right"><font size="-2">[<a href="frames.html"target="_top">frames</a>&nbsp;|&nbsp;<a href="openid.consumer.interface-module.html" target="_top">no&nbsp;frames</a>]</font></td></tr>
    </table></td>
</tr></table>

<!-- =========== START OF MODULE DESCRIPTION =========== -->
<h2 class="module">Module openid.consumer.interface</h2>

This module documents the main interface with the OpenID consumer 
libary. The only part of the library which has to be used and isn't 
documented in full here is the store required to create an <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html" 
class="link"><code>OpenIDConsumer</code></a></code> instance. More on the 
abstract store type and concrete implementations of it that are provided 
in the documentation for the <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#__init__" 
class="link"><code>__init__</code></a></code> method of the <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html" 
class="link"><code>OpenIDConsumer</code></a></code> class.
<h1 class="heading">OVERVIEW</h1>
  The OpenID identity verification process most commonly uses the 
  following steps, as visible to the user of this library:
  <ol start="1">
    <li>
      The user enters their OpenID into a field on the consumer's 
      site, and hits a login button.
    </li>
    <li>
      The consumer site checks that the entered URL describes an 
      OpenID page by fetching it and looking for appropriate link tags in 
      the head section.
    </li>
    <li>
      The consumer site sends the browser a redirect to the identity 
      server. This is the authentication request as described in the 
      OpenID specification.
    </li>
    <li>
      The identity server's site sends the browser a redirect back to 
      the consumer site. This redirect contains the server's response to 
      the authentication request.
    </li>
  </ol>
  The most important part of the flow to note is the consumer's site 
  must handle two separate HTTP requests in order to perform the full 
  identity check.
<h1 class="heading">LIBRARY DESIGN</h1>
  <p>This consumer library is designed with that flow in mind. The goal 
  is to make it as easy as possible to perform the above steps 
  securely.</p>
  <p>At a high level, there are two important parts in the consumer 
  library. The first important part is this module, which contains the 
  interface to actually use this library. The second is the <code><a 
  href="openid.consumer.stores-module.html" 
  class="link"><code>openid.consumer.stores</code></a></code> module, 
  which describes the interface to use if you need to create a custom 
  method for storing the state this library needs to maintain between 
  requests.</p>
  <p>In general, the scond part is less important for users of the 
  library to know about, as several implementations are provided which 
  cover a wide variety of situations in which consumers may use the 
  library.</p>
  This module contains a class, <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html" 
  class="link"><code>OpenIDConsumer</code></a></code>, with methods 
  corresponding to the actions necessary in each of steps 2, 3, and 4 
  described in the overview. Use of this library should be as easy as 
  creating an <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html" 
  class="link"><code>OpenIDConsumer</code></a></code> instance and 
  calling the methods appropriate for the action the site wants to 
  take.
<h1 class="heading">STORES AND DUMB MODE</h1>
  <p>OpenID is a protocol that works best when the consumer site is able 
  to store some state. This is the normal mode of operation for the 
  protocol, and is sometimes referred to as smart mode. There is also a 
  fallback mode, known as dumb mode, which is available when the consumer 
  site is not able to store state. This mode should be avoided when 
  possible, as it leaves the implementation more vulnerable to replay 
  attacks.</p>
  <p>The mode the library works in for normal operation is determined by 
  the store that it is given. The store is an abstraction that handles 
  the data that the consumer needs to manage between http requests in 
  order to operate efficiently and securely.</p>
  <p>Several store implementation are provided, and the interface is 
  fully documented so that custom stores can be used as well. See the 
  documentation for the <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html" 
  class="link"><code>OpenIDConsumer</code></a></code> class for more 
  information on the interface for stores. The concrete implementations 
  that are provided allow the consumer site to store the necessary data 
  in several different ways: in the filesystem, in a MySQL database, or 
  in an SQLite database.</p>
  There is an additional concrete store provided that puts the system 
  in dumb mode. This is not recommended, as it removes the library's 
  ability to stop replay attacks reliably. It still uses time-based 
  checking to make replay attacks only possible within a small window, 
  but they remain possible within that window. This store should only be 
  used if the consumer site has no way to store data between requests at 
  all.
<h1 class="heading">IMMEDIATE MODE</h1>
  <p>In the flow described above, the user may need to confirm to the 
  identity server that it's ok to authorize his or her identity. The 
  server may draw pages asking for information from the user before it 
  redirects the browser back to the consumer's site. This is generally 
  transparent to the consumer site, so it is typically ignored as an 
  implementation detail.</p>
  There can be times, however, where the consumer site wants to get a 
  response immediately. When this is the case, the consumer can put the 
  library in immediate mode. In immediate mode, there is an extra 
  response possible from the server, which is essentially the server 
  reporting that it doesn't have enough information to answer the 
  question yet. In addition to saying that, the identity server provides 
  a URL to which the user can be sent to provide the needed information 
  and let the server finish handling the original request.
<h1 class="heading">USING THIS LIBRARY</h1>
  <p>Integrating this library into an application is usually a relatively 
  straightforward process. The process should basically follow this 
  plan:</p>
  <p>Add an OpenID login field somewhere on your site. When an OpenID is 
  entered in that field and the form is submitted, it should make a 
  request to the your site which includes that OpenID URL.</p>
  <p>When your site receives that request, it should create an <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html" 
  class="link"><code>openid.consumer.interface.OpenIDConsumer</code></a></code> 
  instance, and call <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
  class="link"><code>beginAuth</code></a></code> on it. If <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
  class="link"><code>beginAuth</code></a></code> completes successfully, 
  it will return an <code><a 
  href="openid.consumer.interface.OpenIDAuthRequest-class.html" 
  class="link"><code>OpenIDAuthRequest</code></a></code>. Otherwise it 
  will provide some useful information for giving the user an error 
  message.</p>
  <p>Now that you have the <code><a 
  href="openid.consumer.interface.OpenIDAuthRequest-class.html" 
  class="link"><code>OpenIDAuthRequest</code></a></code> object, you need 
  to preserve the value in its <code><a 
  href="openid.consumer.interface.OpenIDAuthRequest-class.html#token" 
  class="link"><code>token</code></a></code> field for lookup on the 
  user's next request from your site. There are several approaches for 
  doing this which will work. If your environment has any kind of 
  session-tracking system, storing the token in the session is a good 
  approach. If it doesn't you can store the token in either a cookie or 
  in the return_to url provided in the next step.</p>
  <p>The next step is to call the <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html#constructRedirect" 
  class="link"><code>constructRedirect</code></a></code> method on the 
  <code><a href="openid.consumer.interface.OpenIDConsumer-class.html" 
  class="link"><code>OpenIDConsumer</code></a></code> object. Pass it the 
  <code><a href="openid.consumer.interface.OpenIDAuthRequest-class.html" 
  class="link"><code>OpenIDAuthRequest</code></a></code> object returned 
  by the previous call to <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
  class="link"><code>beginAuth</code></a></code> along with the return_to 
  and trust_root URLs. The return_to URL is the URL that the OpenID 
  server will send the user back to after attempting to verify his or her 
  identity. The trust_root is the URL (or URL pattern) that identifies 
  your web site to the user when he or she is authorizing it.</p>
  <p>Next, send the user a redirect to the URL generated by <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html#constructRedirect" 
  class="link"><code>constructRedirect</code></a></code>.</p>
  <p>That's the first half of the process. The second half of the process 
  is done after the user's ID server sends the user a redirect back to 
  your site to complete their login.</p>
  <p>When that happens, the user will contact your site at the URL given 
  as the return_to URL to the <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html#constructRedirect" 
  class="link"><code>constructRedirect</code></a></code> call made above. 
  The request will have several query parameters added to the URL by the 
  identity server as the information necessary to finish the request.</p>
  <p>When handling this request, the first thing to do is check the 
  <code>openid.return_to</code> parameter. If it doesn't match the URL 
  that the request was actually sent to (the URL the request was actually 
  sent to will contain the openid parameters in addition to any in the 
  return_to URL, but they should be identical other than that), that is 
  clearly suspicious, and the request shouldn't be allowed to 
  proceed.</p>
  <p>Otherwise, the next step is to extract the token value set in the 
  first half of the OpenID login. Create a <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html" 
  class="link"><code>OpenIDConsumer</code></a></code> object, and call 
  its <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html#completeAuth" 
  class="link"><code>completeAuth</code></a></code> method with that 
  token and a dictionary of all the query arguments. This call will 
  return a status code and some additional information describing the the 
  server's response. See the documentation for <code><a 
  href="openid.consumer.interface.OpenIDConsumer-class.html#completeAuth" 
  class="link"><code>completeAuth</code></a></code> for a full 
  explanation of the possible responses.</p>
  At this point, you have an identity URL that you know belongs to the 
  user who made that request. Some sites will use that URL directly as 
  the user name. Other sites will want to map that URL to a username in 
  the site's traditional namespace. At this point, you can take whichever 
  action makes the most sense.
<hr/>

<!-- =========== START OF CLASSES =========== -->
<table class="summary" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="summary">
  <th colspan="2">Classes</th></tr>
<tr><td width="15%">
  <b><a href="openid.consumer.interface.OpenIDConsumer-class.html"><code>OpenIDConsumer</code></a></b></td>
  <td>This class is the interface to the OpenID consumer logic.</td></tr>
<tr><td width="15%">
  <b><a href="openid.consumer.interface.OpenIDAuthRequest-class.html"><code>OpenIDAuthRequest</code></a></b></td>
  <td>This class represents an in-progress OpenID authentication 
request.</td></tr>
</table><br />


<!-- =========== START OF VARIABLE SUMMARY =========== -->
<table class="summary" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="summary">
  <th colspan="2">Variable Summary</th></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1"><code>str</code></font></td>
<td><b><a href="openid.consumer.interface-module.html#SUCCESS"><code>SUCCESS</code></a></b>: This is the status code returned when either the of the <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
class="link"><code>beginAuth</code></a></code> or <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#completeAuth" 
class="link"><code>completeAuth</code></a></code> methods return 
successfully.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1"><code>str</code></font></td>
<td><b><a href="openid.consumer.interface-module.html#HTTP_FAILURE"><code>HTTP_FAILURE</code></a></b>: This is the status code <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
class="link"><code>beginAuth</code></a></code> returns when it is unable 
to fetch the OpenID URL the user entered.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1"><code>str</code></font></td>
<td><b><a href="openid.consumer.interface-module.html#PARSE_ERROR"><code>PARSE_ERROR</code></a></b>: This is the status code <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
class="link"><code>beginAuth</code></a></code> returns when the page 
fetched from the entered OpenID URL doesn't contain the necessary link 
tags to function as an identity page.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1"><code>str</code></font></td>
<td><b><a href="openid.consumer.interface-module.html#FAILURE"><code>FAILURE</code></a></b>: This is the status code <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#completeAuth" 
class="link"><code>completeAuth</code></a></code> returns when the value 
it received indicated an invalid login.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1"><code>str</code></font></td>
<td><b><a href="openid.consumer.interface-module.html#SETUP_NEEDED"><code>SETUP_NEEDED</code></a></b>: This is the status code <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#completeAuth" 
class="link"><code>completeAuth</code></a></code> returns when the 
<code><a href="openid.consumer.interface.OpenIDConsumer-class.html" 
class="link"><code>OpenIDConsumer</code></a></code> instance is in 
immediate mode, and the identity server sends back a URL to send the user 
to to complete his or her login.</td></tr>
</table><br />


<!-- =========== START OF VARIABLE DETAILS =========== -->
<table class="details" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="details">
  <th colspan="2">Variable Details</th></tr>
</table>
<table width="100%" class="var-details" bgcolor="#e0e0e0"><tr><td>
<a name="SUCCESS"></a>
<h3>SUCCESS</h3>
This is the status code returned when either the of the <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
class="link"><code>beginAuth</code></a></code> or <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#completeAuth" 
class="link"><code>completeAuth</code></a></code> methods return 
successfully.
<dl>
  <dt></dt>
  <dd>
    <dl>
      <dt><b>Type:</b></dt>
      <dd>
          <code>str</code>

      </dd>
<span title="'success'">      <dt><b>Value:</b></dt>
      <dd><table><tr><td>
<pre class="variable">
<span class="variable-quote">'</span>success<span class="variable-quote">'</span>                                                              </pre>
        </td></tr></table></dd>
</span>    </dl>
  </dd>
</dl></td></tr></table>
<table width="100%" class="var-details" bgcolor="#e0e0e0"><tr><td>
<a name="HTTP_FAILURE"></a>
<h3>HTTP_FAILURE</h3>
This is the status code <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
class="link"><code>beginAuth</code></a></code> returns when it is unable 
to fetch the OpenID URL the user entered.
<dl>
  <dt></dt>
  <dd>
    <dl>
      <dt><b>Type:</b></dt>
      <dd>
          <code>str</code>

      </dd>
<span title="'http failure'">      <dt><b>Value:</b></dt>
      <dd><table><tr><td>
<pre class="variable">
<span class="variable-quote">'</span>http failure<span class="variable-quote">'</span>                                                         </pre>
        </td></tr></table></dd>
</span>    </dl>
  </dd>
</dl></td></tr></table>
<table width="100%" class="var-details" bgcolor="#e0e0e0"><tr><td>
<a name="PARSE_ERROR"></a>
<h3>PARSE_ERROR</h3>
This is the status code <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#beginAuth" 
class="link"><code>beginAuth</code></a></code> returns when the page 
fetched from the entered OpenID URL doesn't contain the necessary link 
tags to function as an identity page.
<dl>
  <dt></dt>
  <dd>
    <dl>
      <dt><b>Type:</b></dt>
      <dd>
          <code>str</code>

      </dd>
<span title="'parse error'">      <dt><b>Value:</b></dt>
      <dd><table><tr><td>
<pre class="variable">
<span class="variable-quote">'</span>parse error<span class="variable-quote">'</span>                                                          </pre>
        </td></tr></table></dd>
</span>    </dl>
  </dd>
</dl></td></tr></table>
<table width="100%" class="var-details" bgcolor="#e0e0e0"><tr><td>
<a name="FAILURE"></a>
<h3>FAILURE</h3>
This is the status code <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#completeAuth" 
class="link"><code>completeAuth</code></a></code> returns when the value 
it received indicated an invalid login.
<dl>
  <dt></dt>
  <dd>
    <dl>
      <dt><b>Type:</b></dt>
      <dd>
          <code>str</code>

      </dd>
<span title="'failure'">      <dt><b>Value:</b></dt>
      <dd><table><tr><td>
<pre class="variable">
<span class="variable-quote">'</span>failure<span class="variable-quote">'</span>                                                              </pre>
        </td></tr></table></dd>
</span>    </dl>
  </dd>
</dl></td></tr></table>
<table width="100%" class="var-details" bgcolor="#e0e0e0"><tr><td>
<a name="SETUP_NEEDED"></a>
<h3>SETUP_NEEDED</h3>
This is the status code <code><a 
href="openid.consumer.interface.OpenIDConsumer-class.html#completeAuth" 
class="link"><code>completeAuth</code></a></code> returns when the 
<code><a href="openid.consumer.interface.OpenIDConsumer-class.html" 
class="link"><code>OpenIDConsumer</code></a></code> instance is in 
immediate mode, and the identity server sends back a URL to send the user 
to to complete his or her login.
<dl>
  <dt></dt>
  <dd>
    <dl>
      <dt><b>Type:</b></dt>
      <dd>
          <code>str</code>

      </dd>
<span title="'setup needed'">      <dt><b>Value:</b></dt>
      <dd><table><tr><td>
<pre class="variable">
<span class="variable-quote">'</span>setup needed<span class="variable-quote">'</span>                                                         </pre>
        </td></tr></table></dd>
</span>    </dl>
  </dd>
</dl></td></tr></table>
<br />


<!-- =========== START OF NAVBAR =========== -->
<table class="navbar" border="0" width="100%" cellpadding="0" bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="center">
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="indices.html">Index</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar" width="100%"></th>
  </tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
  <tr>
    <td align="left"><font size="-2">Generated by Epydoc 2.1 on Thu Oct 13 16:20:17 2005</font></td>
    <td align="right"><a href="http://epydoc.sourceforge.net"
                      ><font size="-2">http://epydoc.sf.net</font></a></td>
  </tr>
</table>
</body>
</html>
